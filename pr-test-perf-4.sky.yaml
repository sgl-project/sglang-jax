# sglang-jax.sky.yaml
resources:
  accelerators: tpu-v6e-4
  accelerator_args:
    tpu_vm: True
    runtime_version: v2-alpha-tpuv6e
file_mounts:
  /home/gcpuser/sky_workdir/sglang-jax: .
run: |
  # git clone https://github.com/sgl-project/sglang-jax.git
  cd sglang-jax && git fetch origin $REF:$REF && git checkout $REF
  uv venv --python 3.12
  source .venv/bin/activate
  uv pip install -e "python[all]"
  cd test/srt
  python3 -m unittest test_bench_serving.TestBenchServing.test_moe_ttft_default
  python3 -m unittest test_bench_serving.TestBenchServing.test_moe_itl_default
  python3 -m unittest test_bench_serving.TestBenchServing.test_moe_input_throughput_default
  python3 -m unittest test_bench_serving.TestBenchServing.test_moe_output_throughput_default
